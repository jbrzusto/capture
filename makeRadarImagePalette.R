#!/usr/bin/Rscript
#
# This generates the file radarImagePalette.rds, whose contents are an integer vector of length 256.
# Each integer represents palette as 0xAABBGGRR, where AA is alpha, and the rest are the red, green,
# and blue components.
#
# Samples values are mapped to colour values like so:
# i = sample / 16
# (i is the zero-based index into the palette).  This converts a 12 bit sample value into
# an 8 bit palette value.  For now, no dithering.
#
# Because of the current DC bias in the video signal, samples values don't go much below 2048, so
# we make the first chunk of the palette be transparent, for a cleaner overlay image.
# Then we ramp through colours and increasing opacity.

# The easiest way to generate the colour values is to use the palette editor in radR, then
# do from the radR console
#
#  cat(deparse(RSS$palette.mat[, 3]), "\n)
#
# where '3' will need to be chosen to find the particular palette you've edited.

pal = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 135135232L,  439156736L, 759955456L, 1063976960L, 1367998464L, 1688862720L,  1992884224L, -1998061568L, -1744894720L, -1677780224L, -1610665984L,  -1543551744L, -1459660288L, -1392546048L, -1325431808L, -1258317568L,  -1191203328L, -1124089088L, -1056974848L, -973083136L, -922878208L,  -873267456L, -840433920L, -790823168L, -757989632L, -725221632L,  -675610880L, -642777344L, -593166592L, -560333056L, -527499520L,  -477888768L, -445055232L, -395444480L, -362676480L, -329842944L,  -280232192L, -247398656L, -197787904L, -164954368L, -132120832L,  -82510080L, -49742080L, -16712189L, -16712946L, -16713702L, -16714459L,  -16715215L, -16715972L, -16716728L, -16717485L, -16718241L, -16718998L,  -16719754L, -16720767L, -16721523L, -16722280L, -16723036L, -16723793L,  -16724549L, -16725306L, -16726062L, -16726819L, -16727575L, -16728331L,  -16729345L, -16731137L, -16733185L, -16735233L, -16737281L, -16739073L,  -16741121L, -16743169L, -16745217L, -16747009L, -16749057L, -16751105L,  -16753153L, -16754945L, -16756993L, -16759041L, -16761089L, -16762881L,  -16764929L, -16766977L, -16768769L, -16770817L, -16772865L, -16774913L,  -16776705L, -100007681L, -183238401L, -266403585L, -349634305L,  -449576705L, -532807425L, -616038145L, -699203329L, -799211265L,  -882376449L, -965607169L, -1048772353L, -1132003073L, -1231945473L,  -1315176193L, -1398341377L, -1481572097L, -1564737281L, -1664745217L,  -1747910401L, -1831141121L, -1914371841L, -2014314241L, -2097544961L )


## pal = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  0L, 0L, 50593792L, 151977984L, 253362176L, 371523584L, 472907776L,  574226432L, 692387840L, 793772032L, 895156224L, 1013317632L,  1114636288L, 1232797696L, 1334181888L, 1435566080L, 1553727488L,  1655111680L, 1756430336L, 1874591744L, 1975975936L, 2077360128L,  -2099445760L, -1998127104L, -1879965696L, -1778581504L, -1744894464L,  -1711337984L, -1694558720L, -1661002240L, -1644222976L, -1610666496L,  -1577110016L, -1560330752L, -1526774272L, -1509995264L, -1476438784L,  -1459659520L, -1426103040L, -1409323776L, -1375767296L, -1358988032L,  -1325431552L, -1291875328L, -1275096064L, -1241539584L, -1224760320L,  -1191203840L, -1174424576L, -1140868096L, -1124088832L, -1090532608L,  -1073753344L, -1040196864L, -1006640384L, -989861120L, -956304640L,  -939525376L, -906232064L, -873332992L, -840433920L, -807534848L,  -757858560L, -724959488L, -692060416L, -659161344L, -626262272L,  -593363200L, -560464128L, -527499520L, -477823232L, -444924160L,  -412025088L, -379126016L, -346226944L, -313327872L, -280428800L,  -230752512L, -197853440L, -164954368L, -132055296L, -99090688L,  -66191616L, -33292544L, -16712184L, -16712430L, -16712675L, -16712921L,  -16713166L, -16713412L, -16713913L, -16714159L, -16714404L, -16714650L,  -16714895L, -16715141L, -16715386L, -16715888L, -16716133L, -16716378L,  -16716624L, -16716869L, -16717115L, -16717360L, -16717606L, -16718107L,  -16718353L, -16718598L, -16718853L, -16719109L, -16719365L, -16719621L,  -16720132L, -16720388L, -16720644L, -16720900L, -16721156L, -16721412L,  -16721668L, -16722180L, -16722436L, -16722691L, -16722947L, -16723203L,  -16723459L, -16723971L, -16724227L, -16724483L, -16724739L, -16724995L,  -16725250L, -16725506L, -16726018L, -16726274L, -16726530L, -16726786L,  -16727042L, -16727298L, -16727554L, -16728065L, -16728321L, -16728577L,  -16728833L, -16729345L, -16731393L, -16733441L, -16735489L, -16737537L,  -16739841L, -16741889L, -16743937L, -16745985L, -16748033L, -16750081L,  -16752129L, -16754177L, -16756225L, -16758273L, -16760321L, -16762625L,  -16764673L, -16766721L, -16768769L, -16770817L, -16772865L, -16774913L,  -16776961L, -100007681L, -183303937L, -266534657L, -332988161L,  -416284417L, -499515137L, -582745857L, -666042113L, -732495617L,  -815726337L, -899022593L, -982253313L, -1065484033L, -1132003073L,  -1215233793L, -1298530049L, -1381760769L, -1464991489L, -1531510529L,  -1614741249L, -1697971969L, -1781268225L, -1847721729L, -1930952449L,  -2014248705L, -2097479425L)

saveRDS(pal, "/home/radar/capture/radarImagePalette.rds")
